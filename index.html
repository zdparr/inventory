<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Precious Metals Inventory</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="styles.css?v=1.1.1" rel="stylesheet">
  </head>
  <body>
    <nav class="navbar navbar-expand-lg border-bottom bg-white">
      <div class="container">
        <span class="navbar-brand fw-semibold">Precious Metals Inventory</span>
        <div class="d-flex gap-2 align-items-center">
          <span id="userEmail" class="text-muted small"></span>
          <button id="signInBtn" class="btn btn-primary btn-sm">Sign in with Google</button>
          <button id="signOutBtn" class="btn btn-outline-secondary btn-sm d-none">Sign out</button>
        </div>
      </div>
    </nav>

    <main class="container py-4">
      <section id="signedOutView" class="d-flex flex-column align-items-center justify-content-center py-5">
        <div class="text-center">
          <h1 class="h3 mb-3">Welcome</h1>
          <p class="text-muted mb-4">Sign in to view your precious metals inventory.</p>
          <div class="text-uppercase small text-muted">Version</div>
          <div id="versionNumber" class="fw-semibold">v0.1.0</div>
        </div>
      </section>

      <section id="authedView">
        <section class="mb-4">
        <div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-2">
          <h1 class="h3 m-0">Dashboard</h1>
          <button id="refreshPricesBtn" class="btn btn-outline-primary btn-sm">Refresh spot prices</button>
        </div>
        <div class="text-muted small">Prices from gold-api.com (USD per troy ounce). Converted to USD per gram for totals.</div>

        <div class="row g-3 mt-2">
          <div class="col-md-4">
            <div class="card shadow-sm">
              <div class="card-body">
                <div class="d-flex justify-content-between">
                  <div>
                    <div class="text-uppercase small text-muted">Total Value</div>
                    <div id="totalValue" class="display-6 fw-semibold">$0.00</div>
                  </div>
                  <div class="badge bg-dark align-self-start">All Metals</div>
                </div>
                <div id="pricesUpdatedAt" class="small text-muted mt-2">Prices not loaded</div>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card shadow-sm">
              <div class="card-body">
                <div class="text-uppercase small text-muted">Gold (XAU)</div>
                <div id="goldPrice" class="h4 m-0">-</div>
                <div id="goldValue" class="small text-muted mt-2">Total: -</div>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card shadow-sm">
              <div class="card-body">
                <div class="text-uppercase small text-muted">Silver (XAG)</div>
                <div id="silverPrice" class="h4 m-0">-</div>
                <div id="silverValue" class="small text-muted mt-2">Total: -</div>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card shadow-sm">
              <div class="card-body">
                <div class="text-uppercase small text-muted">Platinum (XPT)</div>
                <div id="platinumPrice" class="h4 m-0">-</div>
                <div id="platinumValue" class="small text-muted mt-2">Total: -</div>
              </div>
            </div>
          </div>
        </div>
        </section>

        <section id="inventorySection">
        <div class="row g-4">
          <div class="col-lg-5">
            <div class="card shadow-sm">
              <div class="card-body">
                <h2 class="h5">Add Item</h2>
                <form id="itemForm" class="mt-3">
                  <div class="mb-3">
                    <label class="form-label">Metal</label>
                    <select id="metal" class="form-select" required>
                      <option value="gold">Gold</option>
                      <option value="silver">Silver</option>
                      <option value="platinum">Platinum</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Category</label>
                    <select id="category" class="form-select" required>
                      <option id="coinCategoryOption" value="coin">Coin</option>
                      <option value="bullion">Bullion</option>
                    </select>
                  </div>
                  <div id="coinFields">
                    <div class="mb-3">
                      <label id="coinTypeLabel" class="form-label">Coin Type</label>
                      <select id="coinType" class="form-select"></select>
                    </div>
                  </div>
                  <div id="bullionFields" class="d-none">
                    <div class="mb-3">
                      <label class="form-label">Item Name</label>
                      <input id="bullionName" class="form-control" placeholder="1 oz bar, round, etc.">
                    </div>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Grams Per Item</label>
                    <input id="grams" type="number" step="0.0001" min="0" class="form-control" required>
                    <div class="form-text">Editable. Use exact weights for your items.</div>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Quantity</label>
                    <input id="quantity" type="number" step="1" min="1" class="form-control" value="1" required>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Notes</label>
                    <input id="notes" class="form-control" placeholder="Optional">
                  </div>
                  <div id="yearField" class="mb-3 d-none">
                    <label class="form-label">Year</label>
                    <input id="year" type="number" min="1700" max="2100" step="1" class="form-control" placeholder="e.g. 1964">
                  </div>
                  <button class="btn btn-primary w-100" type="submit">Add Item</button>
                </form>
              </div>
            </div>
          </div>
          <div class="col-lg-7">
            <div class="card shadow-sm">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                  <h2 class="h5 m-0">Inventory</h2>
                  <span id="itemCount" class="badge text-bg-secondary">0 items</span>
                </div>
                <div class="row g-2 align-items-center mt-3">
                  <div class="col-md-6">
                    <input id="searchInput" class="form-control" placeholder="Search by type, metal, year, notes">
                  </div>
                  <div class="col-md-3">
                    <select id="metalFilter" class="form-select">
                      <option value="all">All metals</option>
                      <option value="gold">Gold</option>
                      <option value="silver">Silver</option>
                      <option value="platinum">Platinum</option>
                    </select>
                  </div>
                  <div class="col-md-3 text-md-end">
                    <button id="clearFiltersBtn" class="btn btn-outline-secondary w-100 w-md-auto">Clear</button>
                  </div>
                </div>
                <div class="table-responsive mt-3">
                  <table class="table table-sm align-middle">
                    <thead>
                      <tr>
                        <th>Metal</th>
                        <th>Type</th>
                        <th>Year</th>
                        <th>Grams</th>
                        <th>Qty</th>
                        <th>Total Grams</th>
                        <th>Value</th>
                        <th></th>
                      </tr>
                    </thead>
                    <tbody id="itemsBody">
                      <tr>
                        <td colspan="8" class="text-muted">No items yet.</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
        </section>
      </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="app.js?v=1.1.1"></script>
  </body>
</html>
